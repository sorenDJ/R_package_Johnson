---
title: "Cool Beans"
author: "Soren Johnson"
date: "12/2/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Installation

Load in libaries used by this package
```{r}
library(ggplot2)
library(tidyverse)
library(devtools)
```

Install these packages and load them
```{r, eval=FALSE}
install.packages("vcfR")
install.packages("ape")
install.packages("poppr")
devtools::install_github("bcm-uga/LEA")

```

```{r}
library(vcfR)
library(ape)
library(poppr)
library(LEA)
```

Now install own R package

```{r}
devtools::install_github("sorenDJ/R_package_Johnson")
library("CoolBeans")

```

Let us download some data for our package:

```{r}
download.file("https://raw.githubusercontent.com/sorenDJ/R_package_Johnson/master/data/DNA_Samples_Data_Analysis.csv", destfile = "/cloud/project/Output_files/Downloaded_csv.csv")

download.file("https://raw.githubusercontent.com/sorenDJ/R_package_Johnson/master/data/mtDNA_samples_data.txt", destfile = "/cloud/project/data/mtDNA_samples_data.txt")

download.file("https://raw.githubusercontent.com/sorenDJ/R_package_Johnson/master/data/mtDNA_pop.vcf", destfile = "/cloud/project/data/mtDNA_pop.vcf")
```

## Working Example

+ An example of each function and how it works
+ Say something about why this is a good thing to do
+ say something about expected output

```{r}
result <- mult(4, 5)
```

## CleanUpPopData function

This function takes a csv file and converts it to a text file that only includes the data and samples that are specified.

This function is important because some population structure analyses require text files with population data and the samples you want to look at.

Example:
```{r}
pop_data_output(file = "/cloud/project/data/DNA_Samples_Data_Analysis.csv", columns = c(SJ_number, Species, sub_species), sample_col = SJ_number, samples = c("AR01", "AR02", "AR03"), NA_values = c("", "na"), output_file = "/cloud/project/Output_files/test_pop_data.txt")
```

## Sample_counts function

This function is to be used to check the number of samples for different values of a variable and then filter out samples that have a certain value for the variable. These filtered samples will then be created as a new csv file. 

This function can be helpful for organization of data. Often times I might want to know how many samples have already been sequeneced and how many haven't. I then want a CSV file for the samples that haven't been sequenced to know which ones they are.

Example:
```{r}
samp_2B_seq(file = "/cloud/project/data/DNA_Samples_Data_Analysis.csv", na_values = c("", "na"), col2count = strange_topology, output_csv = "/cloud/project/Output_files/test_output.csv", filter = c("yes", NA))
```

## SNMF_Analysis function

This function is to be used to determine the optimal K value given a vcf data set using a sparse non-negative matrix factorization algorithm. This function will output a summary of the cross-validation values for each K and also a plot of K and minimum cross-validation. This function also creates a snmf project object.

This function can help to determine the number of ancestral populations and distinct genetic clusters. The found K value can then be used to plot structure plots. The created snmf project can then also be used for doing analyses in the LEA package.

Example:
```{r, eval=FALSE}
op_K_snmf(vcf_file = "/cloud/project/data/mtDNA_pop.vcf", K = 4:5, new_name = "/cloud/project/Output_files/test_1.geno", repetitions = 2, project_name = "snmf_test_1")
```

## Structure_plot function

This function creates a structure plot from a snmf project for a given value of K. The structure plot displays the probability of each sample belonging to a certain genetic cluster.

This function is important because strucutre plots are a common anlaysis a figure used to look at genetic structure.

Example:
```{r, eval=FALSE}
snmf_structure_plot(project_name = snmf_test_1, K = 4, colors = c("green", "blue", "purple", "red"))
```

## GenLight_creator

This function creates a genlight object from a vcf file. This genlight object can then be used in the adegent pacakge to look at genetic population structure. The genlight object also combines a text file with the vcf data and one variable is chosen to be a population variable.

This function is important because it helps complete many steps in just one step. The genlight object is also important if using the adegent package and this function helps to keep the code organized so less likely to make a mistake.

Example:
```{r}
genlight_creator(vcf_file = "/cloud/project/data/mtDNA_pop.vcf", pop_data = "/cloud/project/data/mtDNA_samples_data.txt", genlight_name = "gl.test", pop_col = sub_species)
```

